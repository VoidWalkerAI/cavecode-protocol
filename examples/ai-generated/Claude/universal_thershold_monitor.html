<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Universal Threshold Monitor</title>
    
    <script>
/* 
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
‚ñà CAVECODE ARTIFACT ‚Äî UNIVERSAL THRESHOLD MONITOR (v1.0)     ‚ñà
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà

Built with CaveCode Protocol v1.0
https://github.com/VoidWalkerAI/cavecode-arcade-planet

========================================
BLOCK 1 ‚Äî IDENTITY (Locked ‚Äî AI will not rewrite)
========================================
Title: Universal Threshold Monitor
Purpose: 
    A survival tool for tracking critical resources (water, power, fuel, 
    food, time) and alerting when levels cross defined thresholds.
    Built for people on the edge who need to know their limits.

For: The citizens of Emberwake and anyone living on the edge.
*/

/*
========================================
üñçÔ∏è BLOCK 2 ‚Äî HUMAN EDIT ZONE (Safe to change)
========================================
Edit these values to customize your monitoring.
These are the ONLY values you need to change.
*/

// === SYSTEM SETTINGS ===
const REFRESH_RATE = 30;              // seconds between auto-checks
const MAX_RESOURCES = 20;             // maximum trackable resources
const ALERT_SOUND_ENABLED = false;    // play sound on alerts
const VISUAL_FLASH_ENABLED = true;    // flash screen on critical
const SILENCE_DURATION = 300;         // seconds alerts stay muted

// === DEFAULT THRESHOLDS ===
const WARNING_THRESHOLD_PERCENT = 25;    // % of max = warning
const CRITICAL_THRESHOLD_PERCENT = 10;   // % of max = critical

// === DEFAULT RESOURCES ===
// You can edit these or add your own in the app
const DEFAULT_RESOURCES = [
    {
        name: 'Water',
        current: 100,
        max: 100,
        unit: 'gallons',
        warning: 25,
        critical: 10
    },
    {
        name: 'Power',
        current: 100,
        max: 100,
        unit: '%',
        warning: 30,
        critical: 15
    },
    {
        name: 'Food',
        current: 30,
        max: 30,
        unit: 'days',
        warning: 7,
        critical: 3
    },
    {
        name: 'Fuel',
        current: 50,
        max: 50,
        unit: 'gallons',
        warning: 12,
        critical: 5
    }
];

/*
========================================
üåê BLOCK 3 ‚Äî PUBLIC TEXT (Safe to edit)
========================================
Change any text that appears in the app.
*/

const UI_TEXT = {
    TITLE: 'Universal Threshold Monitor',
    SUBTITLE: 'Know your limits. Stay alive.',
    STATUS_SAFE: 'Safe',
    STATUS_WARNING: 'Warning',
    STATUS_CRITICAL: 'CRITICAL',
    ALERT_WARNING: 'Resource running low',
    ALERT_CRITICAL: 'CRITICAL: Nearly empty!',
    BUTTON_ADD: '‚ûï Add Resource',
    BUTTON_LOAD_DEFAULTS: 'üîÑ Load Defaults',
    BUTTON_EXPORT: 'üíæ Export Data',
    BUTTON_CLEAR: 'üóëÔ∏è Clear All',
    BUTTON_UPDATE: 'Update',
    BUTTON_REMOVE: 'Remove',
    BUTTON_CANCEL: 'Cancel',
    EMPTY_MESSAGE: 'üìä No resources being tracked. Add one to begin.',
    LAST_UPDATE: 'Last updated',
    MODAL_ADD_TITLE: 'Add Resource',
    MODAL_UPDATE_TITLE: 'Update Resource'
};

/*
========================================
ü™® BLOCK 4 ‚Äî LOCKED LOGIC (Don't edit unless you're a developer)
========================================
The code below makes everything work.
Core game logic that should remain stable.
*/
    </script>
    
    <style>
        /* Visual styling - developers can modify if needed */
        :root {
            --bg-primary: #0a0e14;
            --bg-secondary: #151b24;
            --bg-tertiary: #1f2937;
            --text-primary: #e6edf3;
            --text-secondary: #9ca3af;
            --border: #374151;
            --safe: #10b981;
            --warning: #f59e0b;
            --critical: #ef4444;
            --accent: #3b82f6;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--border);
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--accent);
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-style: italic;
        }

        .controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 30px;
            padding: 20px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
        }

        button {
            padding: 10px 20px;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        button:hover {
            background: #2563eb;
            transform: translateY(-2px);
        }

        button:active {
            transform: translateY(0);
        }

        button.danger {
            background: var(--critical);
        }

        button.danger:hover {
            background: #dc2626;
        }

        button.secondary {
            background: var(--bg-tertiary);
        }

        button.secondary:hover {
            background: #374151;
        }

        .resources-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .resource-card {
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            border-radius: 8px;
            padding: 20px;
            transition: all 0.3s;
        }

        .resource-card.critical {
            border-color: var(--critical);
            animation: pulse 1s infinite;
        }

        .resource-card.warning {
            border-color: var(--warning);
        }

        .resource-card.safe {
            border-color: var(--safe);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        @keyframes flash {
            0%, 100% { background: var(--bg-primary); }
            50% { background: var(--critical); }
        }

        .flash-alert {
            animation: flash 0.5s 3;
        }

        .resource-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .resource-name {
            font-size: 1.2rem;
            font-weight: bold;
        }

        .status-badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: bold;
            text-transform: uppercase;
        }

        .status-safe {
            background: var(--safe);
            color: white;
        }

        .status-warning {
            background: var(--warning);
            color: black;
        }

        .status-critical {
            background: var(--critical);
            color: white;
        }

        .resource-level {
            font-size: 2rem;
            margin: 15px 0;
            font-weight: bold;
        }

        .level-bar {
            width: 100%;
            height: 20px;
            background: var(--bg-tertiary);
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }

        .level-fill {
            height: 100%;
            transition: width 0.5s ease, background 0.3s;
            border-radius: 10px;
        }

        .resource-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .resource-actions {
            display: flex;
            gap: 8px;
            margin-top: 15px;
        }

        .resource-actions button {
            flex: 1;
            padding: 8px;
            font-size: 0.8rem;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            border-radius: 8px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            margin-bottom: 20px;
        }

        .modal-header h2 {
            color: var(--accent);
            margin-bottom: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        input, select {
            width: 100%;
            padding: 10px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 4px;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 1rem;
        }

        input:focus, select:focus {
            outline: none;
            border-color: var(--accent);
        }

        .modal-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .modal-actions button {
            flex: 1;
        }

        .alert-panel {
            position: fixed;
            top: 20px;
            right: 20px;
            max-width: 400px;
            z-index: 999;
        }

        .alert {
            background: var(--bg-secondary);
            border: 2px solid;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .alert.warning {
            border-color: var(--warning);
        }

        .alert.critical {
            border-color: var(--critical);
        }

        .alert-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .alert-close {
            background: none;
            border: none;
            color: var(--text-primary);
            cursor: pointer;
            padding: 0;
            font-size: 1.2rem;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .empty-state p {
            margin-bottom: 20px;
        }

        .last-update {
            text-align: center;
            color: var(--text-secondary);
            font-size: 0.85rem;
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            .resources-grid {
                grid-template-columns: 1fr;
            }

            .controls {
                flex-direction: column;
            }

            button {
                width: 100%;
            }

            .alert-panel {
                left: 20px;
                right: 20px;
                max-width: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1 id="mainTitle">‚ö† Universal Threshold Monitor</h1>
            <p class="subtitle" id="subtitle">Know your limits. Stay alive.</p>
        </header>

        <div class="controls">
            <button onclick="showAddResourceModal()" id="btnAdd">‚ûï Add Resource</button>
            <button onclick="loadDefaults()" class="secondary" id="btnLoadDefaults">üîÑ Load Defaults</button>
            <button onclick="exportData()" class="secondary" id="btnExport">üíæ Export Data</button>
            <button onclick="clearAllResources()" class="danger" id="btnClear">üóëÔ∏è Clear All</button>
        </div>

        <div class="resources-grid" id="resourcesGrid"></div>

        <div class="empty-state" id="emptyState">
            <p id="emptyMessage">üìä No resources being tracked. Add one to begin.</p>
            <button onclick="loadDefaults()">Load Default Resources</button>
        </div>

        <div class="last-update" id="lastUpdate"></div>
    </div>

    <div class="alert-panel" id="alertPanel"></div>

    <!-- Add Resource Modal -->
    <div class="modal" id="addResourceModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalAddTitle">Add Resource</h2>
            </div>
            <div class="form-group">
                <label>Resource Name</label>
                <input type="text" id="newResourceName" placeholder="e.g., Water, Power, Food">
            </div>
            <div class="form-group">
                <label>Current Level</label>
                <input type="number" id="newResourceCurrent" placeholder="100">
            </div>
            <div class="form-group">
                <label>Maximum Capacity</label>
                <input type="number" id="newResourceMax" placeholder="100">
            </div>
            <div class="form-group">
                <label>Unit</label>
                <input type="text" id="newResourceUnit" placeholder="gallons, kWh, days">
            </div>
            <div class="form-group">
                <label>Warning Threshold</label>
                <input type="number" id="newResourceWarning" placeholder="25">
            </div>
            <div class="form-group">
                <label>Critical Threshold</label>
                <input type="number" id="newResourceCritical" placeholder="10">
            </div>
            <div class="modal-actions">
                <button onclick="addResource()">Add</button>
                <button onclick="closeModal('addResourceModal')" class="secondary" id="btnCancel1">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Update Resource Modal -->
    <div class="modal" id="updateResourceModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalUpdateTitle">Update Resource</h2>
            </div>
            <div class="form-group">
                <label>New Level</label>
                <input type="number" id="updateResourceValue">
            </div>
            <div class="modal-actions">
                <button onclick="updateResourceValue()" id="btnUpdate">Update</button>
                <button onclick="closeModal('updateResourceModal')" class="secondary" id="btnCancel2">Cancel</button>
            </div>
        </div>
    </div>

    <script>
        /* 
        ========================================
        ü™® LOCKED LOGIC (Core application code)
        ========================================
        This code reads the human edit zone above and makes the app work.
        Stable logic that should not be modified casually.
        */

        // Apply UI text from CaveCode on load
        function applyUIText() {
            document.getElementById('mainTitle').textContent = '‚ö† ' + UI_TEXT.TITLE;
            document.getElementById('subtitle').textContent = UI_TEXT.SUBTITLE;
            document.getElementById('btnAdd').textContent = UI_TEXT.BUTTON_ADD;
            document.getElementById('btnLoadDefaults').textContent = UI_TEXT.BUTTON_LOAD_DEFAULTS;
            document.getElementById('btnExport').textContent = UI_TEXT.BUTTON_EXPORT;
            document.getElementById('btnClear').textContent = UI_TEXT.BUTTON_CLEAR;
            document.getElementById('emptyMessage').textContent = UI_TEXT.EMPTY_MESSAGE;
            document.getElementById('modalAddTitle').textContent = UI_TEXT.MODAL_ADD_TITLE;
            document.getElementById('modalUpdateTitle').textContent = UI_TEXT.MODAL_UPDATE_TITLE;
            document.getElementById('btnUpdate').textContent = UI_TEXT.BUTTON_UPDATE;
            document.getElementById('btnCancel1').textContent = UI_TEXT.BUTTON_CANCEL;
            document.getElementById('btnCancel2').textContent = UI_TEXT.BUTTON_CANCEL;
        }

        // State
        let resources = [];
        let currentUpdateResource = null;
        let alertsSilenced = false;
        let silenceTimeout = null;

        // Load from localStorage on start
        function loadState() {
            const saved = localStorage.getItem('thresholdMonitor');
            if (saved) {
                resources = JSON.parse(saved);
            }
        }

        // Save to localStorage
        function saveState() {
            localStorage.setItem('thresholdMonitor', JSON.stringify(resources));
        }

        // Default resources (from CaveCode Block 2)
        function loadDefaults() {
            resources = DEFAULT_RESOURCES.map((r, i) => ({
                ...r,
                id: Date.now() + i
            }));
            saveState();
            render();
        }

        // Get resource status
        function getStatus(resource) {
            if (resource.current <= resource.critical) return 'critical';
            if (resource.current <= resource.warning) return 'warning';
            return 'safe';
        }

        // Get status text (from CaveCode Block 3)
        function getStatusText(status) {
            const texts = {
                safe: UI_TEXT.STATUS_SAFE,
                warning: UI_TEXT.STATUS_WARNING,
                critical: UI_TEXT.STATUS_CRITICAL
            };
            return texts[status] || 'Unknown';
        }

        // Calculate percentage
        function getPercentage(resource) {
            return Math.round((resource.current / resource.max) * 100);
        }

        // Show alert (uses CaveCode settings)
        function showAlert(resource, status) {
            if (alertsSilenced) return;

            const panel = document.getElementById('alertPanel');
            const alert = document.createElement('div');
            alert.className = `alert ${status}`;
            
            const message = status === 'critical' 
                ? `${UI_TEXT.ALERT_CRITICAL} ${resource.name}`
                : `${UI_TEXT.ALERT_WARNING}: ${resource.name}`;

            alert.innerHTML = `
                <div class="alert-header">
                    <strong>${message}</strong>
                    <button class="alert-close" onclick="this.parentElement.parentElement.remove()">√ó</button>
                </div>
                <div>${resource.current} ${resource.unit} remaining (${getPercentage(resource)}%)</div>
            `;

            panel.appendChild(alert);

            // Flash screen if enabled (from CaveCode tuning knob)
            if (VISUAL_FLASH_ENABLED && status === 'critical') {
                document.body.classList.add('flash-alert');
                setTimeout(() => document.body.classList.remove('flash-alert'), 1500);
            }

            // Auto-remove after 10 seconds if not persistent
            if (!PERSISTENT_ALERTS) {
                setTimeout(() => alert.remove(), 10000);
            }
        }

        // Check thresholds
        function checkThresholds() {
            resources.forEach(resource => {
                const status = getStatus(resource);
                if (status === 'critical' || status === 'warning') {
                    showAlert(resource, status);
                }
            });
        }

        // Render resources
        function render() {
            const grid = document.getElementById('resourcesGrid');
            const emptyState = document.getElementById('emptyState');

            if (resources.length === 0) {
                grid.style.display = 'none';
                emptyState.style.display = 'block';
                return;
            }

            grid.style.display = 'grid';
            emptyState.style.display = 'none';

            grid.innerHTML = resources.map(resource => {
                const status = getStatus(resource);
                const percentage = getPercentage(resource);
                const color = status === 'critical' ? '#ef4444' : 
                             status === 'warning' ? '#f59e0b' : '#10b981';

                return `
                    <div class="resource-card ${status}">
                        <div class="resource-header">
                            <div class="resource-name">${resource.name}</div>
                            <div class="status-badge status-${status}">${getStatusText(status)}</div>
                        </div>
                        <div class="resource-level">
                            ${resource.current} ${resource.unit}
                        </div>
                        <div class="level-bar">
                            <div class="level-fill" style="width: ${percentage}%; background: ${color};"></div>
                        </div>
                        <div class="resource-details">
                            <div>Max: ${resource.max} ${resource.unit}</div>
                            <div>Level: ${percentage}%</div>
                            <div>Warning: ${resource.warning} ${resource.unit}</div>
                            <div>Critical: ${resource.critical} ${resource.unit}</div>
                        </div>
                        <div class="resource-actions">
                            <button onclick="showUpdateModal(${resource.id})">${UI_TEXT.BUTTON_UPDATE}</button>
                            <button onclick="removeResource(${resource.id})" class="danger">${UI_TEXT.BUTTON_REMOVE}</button>
                        </div>
                    </div>
                `;
            }).join('');

            // Update timestamp (from CaveCode Block 3)
            document.getElementById('lastUpdate').textContent = 
                `${UI_TEXT.LAST_UPDATE}: ${new Date().toLocaleString()}`;
        }

        // Modal functions
        function showAddResourceModal() {
            document.getElementById('addResourceModal').classList.add('active');
        }

        function showUpdateModal(id) {
            currentUpdateResource = resources.find(r => r.id === id);
            if (currentUpdateResource) {
                document.getElementById('updateResourceValue').value = currentUpdateResource.current;
                document.getElementById('updateResourceModal').classList.add('active');
            }
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // Add resource (uses CaveCode tuning knobs for defaults)
        function addResource() {
            const name = document.getElementById('newResourceName').value;
            const current = parseFloat(document.getElementById('newResourceCurrent').value);
            const max = parseFloat(document.getElementById('newResourceMax').value);
            const unit = document.getElementById('newResourceUnit').value;
            const warning = parseFloat(document.getElementById('newResourceWarning').value);
            const critical = parseFloat(document.getElementById('newResourceCritical').value);

            if (!name || isNaN(current) || isNaN(max)) {
                alert('Please fill in all required fields');
                return;
            }

            if (resources.length >= MAX_RESOURCES) {
                alert(`Maximum of ${MAX_RESOURCES} resources allowed`);
                return;
            }

            resources.push({
                id: Date.now(),
                name,
                current,
                max,
                unit: unit || 'units',
                warning: warning || (max * WARNING_THRESHOLD_PERCENT / 100),
                critical: critical || (max * CRITICAL_THRESHOLD_PERCENT / 100)
            });

            saveState();
            render();
            closeModal('addResourceModal');

            // Clear form
            document.getElementById('newResourceName').value = '';
            document.getElementById('newResourceCurrent').value = '';
            document.getElementById('newResourceMax').value = '';
            document.getElementById('newResourceUnit').value = '';
            document.getElementById('newResourceWarning').value = '';
            document.getElementById('newResourceCritical').value = '';
        }

        // Update resource value
        function updateResourceValue() {
            if (!currentUpdateResource) return;

            const newValue = parseFloat(document.getElementById('updateResourceValue').value);
            if (isNaN(newValue)) {
                alert('Please enter a valid number');
                return;
            }

            currentUpdateResource.current = Math.max(0, Math.min(newValue, currentUpdateResource.max));
            saveState();
            render();
            checkThresholds();
            closeModal('updateResourceModal');
        }

        // Remove resource
        function removeResource(id) {
            if (confirm('Are you sure you want to remove this resource?')) {
                resources = resources.filter(r => r.id !== id);
                saveState();
                render();
            }
        }

        // Clear all
        function clearAllResources() {
            if (confirm('Are you sure you want to clear all resources? This cannot be undone.')) {
                resources = [];
                saveState();
                render();
            }
        }

        // Export data
        function exportData() {
            const data = JSON.stringify(resources, null, 2);
            const blob = new Blob([data], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `threshold-monitor-${Date.now()}.json`;
            a.click();
        }

        // Auto-update loop (uses REFRESH_RATE from CaveCode)
        setInterval(() => {
            checkThresholds();
        }, REFRESH_RATE * 1000);

        // Initialize
        applyUIText();  // Apply text from CaveCode
        loadState();
        render();

        // Check thresholds on load
        setTimeout(() => checkThresholds(), 1000);

        // Close modals with Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.classList.remove('active');
                });
            }
        });
    </script>
</body>
</html>
